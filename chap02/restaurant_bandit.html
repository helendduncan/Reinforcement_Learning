

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>1.1 Multi-armed bandits: 3 restaurants &#8212; Reinforcement Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap02/restaurant_bandit';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/abstract.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/abstract.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Reinforcement Learning: An overview:
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="restaurant_too.html">1.1 Multi-armed bandits: 3 restaurants</a></li>




<li class="toctree-l1"><a class="reference internal" href="ch2_questions.html">Chapter 2 selected questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chap03/ch3_comments.html">Markov Decision Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap03/ch3_questions.html">Chapter 3 selected questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Q-Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../qlearning/qlearning.html">Using Q-learning on a classic control problem</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chap02/restaurant_bandit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1.1 Multi-armed bandits: 3 restaurants</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1.1 Multi-armed bandits: 3 restaurants</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#purely-explorative">1.2 Purely Explorative</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#purely-exploitative">1.3 Purely Exploitative</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#epsilon-greedy">1.4 Epsilon Greedy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">1.5 Analysis</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="multi-armed-bandits-3-restaurants">
<h1>1.1 Multi-armed bandits: 3 restaurants<a class="headerlink" href="#multi-armed-bandits-3-restaurants" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Here we have a setup discussed on <a class="reference external" href="https://www.youtube.com/watch?v=e3L4VocZnnQ">YouTube</a> about a visiting professor spending 300 days in a new town. The professor wants to optimise their dining enjoyment of three restaurants. R1, R2 and R3. Each resturant will give an ‘average’ satisfaction for a meal with some distribution. The goal is to maximise the professors enjoyment and minimise their regret.</p>
<p>I’m choosing this as it’s similar enough to the 10-armed bandit problem that the epsilon-greedy approaches can be looked at, but it is small enough that all the steps should be easy to follow</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">restaurants</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Graph the probability distributions of the three restaurants based on the video</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">m</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#Mean for each of the 3 restaurants</span>
    <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">2.5</span><span class="p">]</span> <span class="c1">#Standard deviation for each of the 3 restaurants</span>
    
    <span class="n">rest</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Restaurant 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 3&#39;</span><span class="p">]</span>
    <span class="n">colour</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span><span class="s1">&#39;mediumpurple&#39;</span><span class="p">]</span>
    <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">ncols</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span><span class="o">/</span><span class="n">nrows</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax2d</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ax2d</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rest</span><span class="p">):</span>
        <span class="n">mu</span><span class="o">=</span><span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">]</span>
        <span class="n">sigma</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="n">count</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="n">colour</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">rest</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">show_all_three</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Graph the probability distributions of the three restaurants together</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#Mean for each of the 3 restaurants</span>
    <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">2.5</span><span class="p">]</span> <span class="c1">#Standard deviation for each of the 3 restaurants</span>
    
    <span class="n">rest</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Restaurant 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 3&#39;</span><span class="p">]</span>
    <span class="n">colour</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span><span class="s1">&#39;mediumpurple&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rest</span><span class="p">):</span>
        <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">count</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="n">colour</span><span class="p">[</span><span class="n">count</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">rest</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Satisfaction&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
<span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a value for the happiness after a visit based on the restaurant&#39;s probability distributions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">m</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#Mean for each of the 3 restaurants</span>
    <span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">2.5</span><span class="p">]</span> <span class="c1">#Standard deviation for each of the 3 restaurants</span>
    
    <span class="c1"># Generate numbers consistent with the distributions provided</span>
    <span class="c1">#nsample=1000 #1000 points made up this distribution</span>
    <span class="c1">#r1=np.random.normal(m[0],s[0],nsample)</span>
    <span class="c1">#r2=np.random.normal(m[1],s[1],nsample)</span>
    <span class="c1">#r3=np.random.normal(m[2],s[2],nsample)</span>
    
    <span class="n">op</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<p>Here we have the distributions of satisfactions for each restaurant. Restaurant 1 has an average satisfaction of 10, with a standard deviation of 5. Restaurant 2 has an average satisfaction of 8, with a standard deviation of 4. Restaurant 3 has an average satisfaction of 5, with a standard deviation of 2.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_all_three</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de758eb282fa59273706f07255c1f3b1e948f5bdcfbbd604ef52816fa5d3d938.png" src="../_images/de758eb282fa59273706f07255c1f3b1e948f5bdcfbbd604ef52816fa5d3d938.png" />
</div>
</div>
</section>
<section id="purely-explorative">
<h1>1.2 Purely Explorative<a class="headerlink" href="#purely-explorative" title="Permalink to this heading">#</a></h1>
<p>In this example the professor will split their time between the three restaurants. So if they are visiting for 300 days, they will visit each of the three restaurants, 100 times each.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Set the initial satisfaction to be 0</span>
<span class="n">explore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">satisfaction</span><span class="o">=</span><span class="mi">0</span>
<span class="n">nrest</span><span class="o">=</span><span class="mi">3</span>
<span class="n">ndaystot</span><span class="o">=</span><span class="mi">300</span>
<span class="n">nvisits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ndaystot</span><span class="o">/</span><span class="n">nrest</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span> <span class="c1">#Each of the 3 restaurants</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvisits</span><span class="p">):</span> <span class="c1">#number of visits to each restaurant</span>
        <span class="n">satisfaction</span><span class="o">=</span><span class="n">satisfaction</span><span class="o">+</span><span class="n">visit</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">explore</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The satisfaction using a purely explorative method is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">explore</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The satisfaction using a purely explorative method is 2404
[100. 100. 100.]
</pre></div>
</div>
</div>
</div>
</section>
<section id="purely-exploitative">
<h1>1.3 Purely Exploitative<a class="headerlink" href="#purely-exploitative" title="Permalink to this heading">#</a></h1>
<p>In this example the professor visits each of the restaurants only once and based on that one visit decides to exclusively frequent the one which gave them the highest satisfaction score on that first visit.
This is known as an exploitative search as you are exploiting the knowledge you already have from one visit to each restaurant to decide on where you will eat.
The downside to this is that the satisfaction from each restaurant is derived from a distribution, and looking at the distributions of all three, we can see there is overlap between them all.
Restaurant 1 (yellow in the diagram) has the highest mean, but a large standard deviation. Restaurant 1 will not always give you the greatest satisfaction, it depends on where in the distribution the visit samples from.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">satisfaction</span><span class="o">=</span><span class="mi">0</span>
<span class="n">exploit</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">iscore</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Initial score for the restaurant</span>
<span class="n">rest</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Restaurant 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Restaurant 3&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">iscore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">visit</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">exploit</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">bestrest</span><span class="o">=</span><span class="n">iscore</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">iscore</span><span class="p">))</span>
<span class="n">satisfaction</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">iscore</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Based on a single visit to each; the professor will exclusively dine at &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">rest</span><span class="p">[</span><span class="n">bestrest</span><span class="p">]</span><span class="si">}</span><span class="s1"> which &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;gave a satisfaction value of </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bestrest</span><span class="p">)</span>


<span class="c1"># The professor will now visit the resaurant that made the favourable first impression for the </span>
<span class="c1"># rest of their visit</span>
<span class="n">nvisits</span><span class="o">=</span><span class="n">ndaystot</span><span class="o">-</span><span class="n">nrest</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvisits</span><span class="p">):</span>
    <span class="n">satisfaction</span><span class="o">=</span><span class="n">satisfaction</span><span class="o">+</span><span class="n">visit</span><span class="p">(</span><span class="n">bestrest</span><span class="p">)</span>
    <span class="n">exploit</span><span class="p">[</span><span class="n">bestrest</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The overall satisfaction using a purely exploitative method is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Based on a single visit to each; the professor will exclusively dine at Restaurant 1 which gave a satisfaction value of 14.27
[1. 1. 1.]
0
The overall satisfaction using a purely exploitative method is 1544
[  1.   1. 298.]
</pre></div>
</div>
</div>
</div>
</section>
<section id="epsilon-greedy">
<h1>1.4 Epsilon Greedy<a class="headerlink" href="#epsilon-greedy" title="Permalink to this heading">#</a></h1>
<p>In the epsilon greedy example, we try to balance the desire to explore (to get to know the distributions of the three restaurants sufficiently well) with the desire to exploit (to go to the restaurant that will give us the greatest satisfaction).
The process here, is to pick a value of epsilon (say 10%) and for that percentage of the time of the professor’s visit, they will pick a restaurant at random. For the other 90% of the time in this case, they will visit the restaurant that they have calculated will give them the greatest satisfaction. Now this calculation may change after more visits to the three restaurants give a more realistic idea of their satisfaction.
As with the exploitative method, we do need to start with one visit to each restaurant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">first_visits</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function to visit the three restaurants once each and return the number of the</span>
<span class="sd">    restaurant with the highest satisfaction after one visit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iscore</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Initial score for the restaurant</span>
    <span class="n">summary</span> <span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="c1">#Summary of the results for the 3 restaurants</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">vis</span><span class="o">=</span><span class="n">visit</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">iscore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>
        <span class="n">summary</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">vis</span>
        
    <span class="n">bestrest</span><span class="o">=</span><span class="n">iscore</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">iscore</span><span class="p">))</span>
    <span class="n">r1</span><span class="o">=</span><span class="p">[];</span> <span class="n">r2</span><span class="o">=</span><span class="p">[];</span> <span class="n">r3</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">r1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> 
    <span class="n">r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> 
    <span class="n">r3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">bestrest</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a value for epsilon</span>
<span class="n">epsilon</span><span class="o">=</span><span class="mi">10</span>

<span class="n">best</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span> <span class="o">=</span> <span class="n">first_visits</span><span class="p">()</span>
<span class="n">satisfaction</span><span class="o">=</span><span class="n">r1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">r2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">r3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Based on one visit, the best restaurant is Restaurant #</span><span class="si">{</span><span class="n">best</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The scores are: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total satisfaction after the inital 3 visits is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ndaystot</span><span class="o">=</span><span class="mi">300</span>
<span class="n">nvisits</span><span class="o">=</span><span class="n">ndaystot</span><span class="o">-</span><span class="mi">3</span>
<span class="n">results</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="c1"># Now the professor has 297 days to either explore or exploit. There is a epsilon percent</span>
<span class="c1"># chance that on any given day the professor will visit a random restaurant and not</span>
<span class="c1"># necessarily the best restaurant based on their current information</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvisits</span><span class="p">):</span>
    <span class="n">ep_tst</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ep_tst</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="o">/</span><span class="mf">100.</span><span class="p">):</span> <span class="c1"># If a random number between 0 and 1 is below 0.1 then</span>
        <span class="c1"># Pick a random restaurant (between 0 and 2) and add the score to the list</span>
        <span class="n">rest</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">val</span><span class="o">=</span><span class="n">visit</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rest</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rest</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rest</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">r3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c1"># Work out the averages of each list and pick the restaurant with the highest</span>
        <span class="c1"># average rating</span>
        <span class="n">averages</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r3</span><span class="p">)]</span>
        <span class="n">best</span><span class="o">=</span><span class="n">averages</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">averages</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span><span class="o">=</span><span class="n">visit</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">best</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">best</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">best</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">r3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">averages</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r3</span><span class="p">)]</span>
        <span class="n">best</span><span class="o">=</span><span class="n">averages</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">averages</span><span class="p">))</span> 
    <span class="n">satisfaction</span><span class="o">=</span><span class="n">satisfaction</span><span class="o">+</span><span class="n">val</span>
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;At the end of their visit, the professor thinks Restaurant #</span><span class="si">{</span><span class="n">best</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> is the best&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The professor visited restaurant #1 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span><span class="si">}</span><span class="s2"> times, Restaurant #2 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span><span class="si">}</span><span class="s2"> times and Restaurant #3 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">r3</span><span class="p">)</span><span class="si">}</span><span class="s2"> times&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Their satisfaction was </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s2"> using the epsilon-greedy method with epsilon = </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Based on one visit, the best restaurant is Restaurant #1
The scores are: 11.19, 4.59, 0.61
The total satisfaction after the inital 3 visits is 16
At the end of their visit, the professor thinks Restaurant #2 is the best
The professor visited restaurant #1 25 times, Restaurant #2 264 times and Restaurant #3 11 times
Their satisfaction was 2732 using the epsilon-greedy method with epsilon = 10%
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis">
<h1>1.5 Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">#</a></h1>
<p>So what can we say about the number of times the optimal restaurant was picked. (Where we define optimal as the restaurant with the highest mean satisfaction, therefore is Restaurant 1)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Put it all together</span>
<span class="c1"># Explore</span>
<span class="k">def</span> <span class="nf">explore</span><span class="p">():</span>
    <span class="n">explore</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">satisfaction</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">300</span><span class="p">):</span>
        <span class="n">rd</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rd</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">explore</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">satisfaction</span> <span class="o">=</span> <span class="n">satisfaction</span> <span class="o">+</span> <span class="n">visit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">rd</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">explore</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">satisfaction</span> <span class="o">=</span> <span class="n">satisfaction</span> <span class="o">+</span> <span class="n">visit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rd</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">explore</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">satisfaction</span> <span class="o">=</span> <span class="n">satisfaction</span> <span class="o">+</span> <span class="n">visit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">percent</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">explore</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">explore</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The satisfaction using a purely explorative method is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The optimal restaurant was picked </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">percent</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">% of the time.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
    <span class="n">exploit</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">first_visit</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">satisfaction</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">satisfaction</span> <span class="o">=</span> <span class="n">satisfaction</span> <span class="o">+</span> <span class="n">visit</span><span class="p">(</span><span class="n">_</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">first_visit</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">satisfaction</span>
        <span class="n">exploit</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">best_one_vis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">first_visit</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">best_one_vis</span><span class="p">,</span> <span class="n">first_visit</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">297</span><span class="p">):</span>
        <span class="n">satisfaction</span> <span class="o">=</span> <span class="n">satisfaction</span> <span class="o">+</span> <span class="n">visit</span><span class="p">(</span><span class="n">best_one_vis</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">exploit</span><span class="p">[</span><span class="n">best_one_vis</span><span class="p">]</span> <span class="o">+=</span>  <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first_visit</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The satisfaction using a purely explorative method is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The optimal restaurant was picked </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">percent</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">% of the time.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">explore</span><span class="p">()</span>
<span class="n">exploit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The satisfaction using a purely explorative method is 2231
The optimal restaurant was picked 34.33% of the time.
2 [ 8.09451401 17.18194652 26.14599605]
[ 8.09451401 17.18194652 26.14599605]
[  1.   1. 298.]
The satisfaction using a purely explorative method is 2930
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">explore</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">exploit</span><span class="p">()</span>

<span class="nn">Cell In[8], line 38,</span> in <span class="ni">exploit</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="nb">print</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The satisfaction using a purely explorative method is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">satisfaction</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">38</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The optimal restaurant was picked </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">percent</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">% of the time.&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;percent&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chap02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1.1 Multi-armed bandits: 3 restaurants</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#purely-explorative">1.2 Purely Explorative</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#purely-exploitative">1.3 Purely Exploitative</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#epsilon-greedy">1.4 Epsilon Greedy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">1.5 Analysis</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Helen Duncan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>