

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The 10 armed bandit problem &#8212; Reinforcement Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap02/nov_10_armed_bandit';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/abstract.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/abstract.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Reinforcement Learning: An overview:
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="restaurant_too.html">1.1 Multi-armed bandits: 3 restaurants</a></li>




<li class="toctree-l1"><a class="reference internal" href="ch2_questions.html">Chapter 2 selected questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chap03/ch3_comments.html">Markov Decision Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap03/ch3_questions.html">Chapter 3 selected questions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Q-Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../qlearning/qlearning.html">Using Q-learning on a classic control problem</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chap02/nov_10_armed_bandit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The 10 armed bandit problem</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">The 10 armed bandit problem</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#start-again-this-time-working-as-outlined-on-page-68-of-lab-book-2">Start again: This time working as outlined on page 68 of lab book #2</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-10-armed-bandit-problem">
<h1>The 10 armed bandit problem<a class="headerlink" href="#the-10-armed-bandit-problem" title="Permalink to this heading">#</a></h1>
<p>Initially we pick k (10) values from a normal distribution with mu = 0 and sigma = 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">secrets</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_bandit</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">action_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">action_values</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">greedy_actual_reward</span><span class="p">(</span><span class="n">action_values</span><span class="p">):</span>
    <span class="n">opt_arm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">action_values</span><span class="p">)</span>
    <span class="n">reward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">action_values</span><span class="p">[</span><span class="n">opt_arm</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">reward</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sample_average</span><span class="p">(</span><span class="n">sum_rewards</span><span class="p">,</span> <span class="n">npulls</span><span class="p">):</span>
    <span class="n">updated_average</span> <span class="o">=</span> <span class="n">sum_rewards</span><span class="o">/</span><span class="n">npulls</span>
    <span class="k">return</span><span class="p">(</span><span class="n">updated_average</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">run_experiment</span><span class="p">(</span><span class="n">action_values</span><span class="p">,</span> <span class="n">npulls</span><span class="p">):</span>
    <span class="n">results_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npulls</span><span class="p">)</span>
    <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">sum_rewards</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npulls</span><span class="p">):</span>
        <span class="n">Rt</span> <span class="o">=</span> <span class="n">greedy_actual_reward</span><span class="p">(</span><span class="n">action_values</span><span class="p">)</span>
        <span class="n">sum_rewards</span> <span class="o">+=</span> <span class="n">Rt</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">average</span> <span class="o">=</span> <span class="n">sample_average</span><span class="p">(</span><span class="n">sum_rewards</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>
        <span class="n">results_array</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">average</span>
    <span class="k">return</span><span class="p">(</span><span class="n">average</span><span class="p">,</span> <span class="n">results_array</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">run_lots_of_experiments</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">npulls</span><span class="p">,</span> <span class="n">nexperiments</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nexperiments</span><span class="p">)</span>
    <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">sum_rewards</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nexperiments</span><span class="p">):</span>
        <span class="n">action_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="c1"># Generate a new set of 10-armed bandits for each experiment</span>
        <span class="n">experiment_result</span><span class="p">,</span> <span class="n">average_array</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="n">action_values</span><span class="p">,</span> <span class="n">npulls</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment_result</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">av</span><span class="o">=</span><span class="n">setup_bandit</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Action Values = &quot;</span><span class="p">,</span><span class="n">av</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The best arm is #&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">av</span><span class="p">),</span> <span class="s2">&quot;which gives a value of &quot;</span> <span class="p">,</span> <span class="n">av</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">av</span><span class="p">)])</span>
<span class="n">npulls</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">average_reward</span><span class="p">,</span> <span class="n">average_array</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="n">av</span><span class="p">,</span> <span class="n">npulls</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For one run,the average reward is&quot;</span><span class="p">,</span> <span class="n">average_reward</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Action Values =  [ 1.49254653  0.90075805  0.8790967  -0.04611066 -0.87069651 -0.27764873
 -0.73861571 -0.56551661  2.14043155  0.29471287]
The best arm is # 8 which gives a value of  2.1404315531748774
For one run,the average reward is 2.135031360576699
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">average_array</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">average_array</span><span class="p">))</span>
<span class="c1"># Plot the results of one run of a thousand pulls...</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">average_array</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">average_array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Results from one run of epsilon greedy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.66139916 2.00331294 2.22543518 1.83883179 2.30089711 2.29712279
 2.32477548 2.21141327 2.0995682  2.19717229 2.25554263 2.29300765
 2.27412575 2.29700141 2.30630159 2.19199001 2.19239288 2.24669447
 2.20381619 2.23089748 2.30122842 2.21745149 2.20833564 2.20960091
 2.22474209 2.17021021 2.15246535 2.15175063 2.15576619 2.2016014
 2.25330785 2.26364403 2.29681058 2.31534596 2.26330859 2.26328196
 2.27738146 2.32478132 2.28938668 2.2836636  2.29129996 2.27222072
 2.29796319 2.31887241 2.30993984 2.333866   2.29698153 2.31341175
 2.30201628 2.30680666 2.31324577 2.32665162 2.31917729 2.30981083
 2.33929114 2.34525617 2.33762827 2.3338549  2.36205842 2.3644386
 2.38566631 2.37776387 2.37671    2.35835542 2.33371952 2.32574458
 2.32240548 2.3344929  2.32998356 2.33558559 2.34087571 2.35585422
 2.34704827 2.3459022  2.34006008 2.30553361 2.29208312 2.28898267
 2.30075301 2.31531448 2.29862574 2.29522866 2.28829915 2.31168994
 2.30493977 2.31234126 2.3294742  2.34686728 2.33295842 2.33250978
 2.33458948 2.31133434 2.31471853 2.32940797 2.32528532 2.32127388
 2.32883202 2.30811669 2.31457432 2.31943203 2.32901887 2.32637553
 2.33904541 2.32589235 2.32587856 2.3308892  2.32478427 2.3236007
 2.32071975 2.30990974 2.31967772 2.30167186 2.3055464  2.30894405
 2.31248383 2.29951376 2.30286009 2.29362526 2.28735624 2.2923319
 2.30234215 2.29018517 2.30036495 2.29886415 2.30002974 2.2971331
 2.29761279 2.28703233 2.2855712  2.28270442 2.27873385 2.28232903
 2.29013885 2.2904084  2.29605104 2.29898926 2.30221244 2.30007945
 2.30116807 2.30351917 2.29709967 2.29841788 2.30072101 2.29747403
 2.29543558 2.28835874 2.28784962 2.28554194 2.28574633 2.27836132
 2.27790688 2.26910856 2.26596269 2.27116158 2.27171575 2.27711023
 2.27912422 2.2793186  2.26645123 2.26750568 2.26901927 2.27169142
 2.27416901 2.26933309 2.26081509 2.26293661 2.27102606 2.27808155
 2.2747755  2.28219346 2.2740812  2.27804687 2.27848725 2.28107465
 2.28459387 2.27451632 2.27273441 2.26582421 2.25904849 2.26398571
 2.26276574 2.25693016 2.26226352 2.25990325 2.25653387 2.25564552
 2.25405752 2.24805068 2.24545208 2.24343522 2.2413338  2.25524542
 2.24280297 2.24314996 2.24482612 2.24453186 2.24701416 2.238617
 2.22950041 2.22374897 2.22753678 2.22872867 2.22266031 2.2222845
 2.23187371 2.23693279 2.23385846 2.2357672  2.24010417 2.2402229
 2.23957383 2.2347599  2.23679473 2.23128091 2.23049527 2.22067754
 2.21561506 2.21158937 2.21771435 2.21014313 2.2072123  2.21593403
 2.22092489 2.22635827 2.22981165 2.22655761 2.23326012 2.22776607
 2.23472726 2.22785164 2.23404126 2.23222841 2.22874418 2.2280537
 2.22803476 2.22752206 2.22163375 2.22033271 2.21647354 2.21422781
 2.21218254 2.21814151 2.21470859 2.2127499  2.2097805  2.20969452
 2.21507185 2.21408589 2.21633148 2.21123808 2.20562148 2.2038572
 2.20661523 2.21062312 2.20515704 2.20223272 2.19975609 2.20219084
 2.2063109  2.20620358 2.19950329 2.19248047 2.19162232 2.18697654
 2.18768314 2.19034024 2.19126899 2.18897541 2.18839632 2.19219135
 2.18813448 2.18875572 2.19134875 2.18959412 2.18783685 2.18078636
 2.18159191 2.18114915 2.17896235 2.18161858 2.18507472 2.18421501
 2.18171809 2.17898168 2.18212465 2.18449314 2.18360278 2.18527265
 2.18579185 2.19072788 2.19151403 2.19455427 2.19258549 2.18748155
 2.18626137 2.18672618 2.18455137 2.18473504 2.18554379 2.18912023
 2.18658476 2.19223427 2.18912413 2.1864871  2.18453059 2.18549097
 2.18192818 2.1846293  2.18690795 2.18314317 2.18058692 2.18872301
 2.19780835 2.20049578 2.19533094 2.19470522 2.19321917 2.19855106
 2.19691984 2.20276982 2.20387337 2.20119005 2.20090035 2.2012214
 2.20311516 2.19981056 2.19898094 2.195774   2.20060514 2.19924449
 2.19738822 2.20334925 2.20370359 2.20541367 2.20569374 2.20385436
 2.20108749 2.1980276  2.19303782 2.19017256 2.18938673 2.18936638
 2.19027366 2.18802763 2.18931278 2.18548701 2.18591052 2.18456902
 2.18419936 2.17847724 2.17927851 2.17896803 2.18010413 2.18214352
 2.17784969 2.1805545  2.17767948 2.17987881 2.18033156 2.1800193
 2.17752608 2.1811857  2.18034144 2.18196137 2.17975142 2.18122709
 2.1821036  2.18572095 2.18529963 2.18572135 2.1864932  2.18702932
 2.18068782 2.18102264 2.18183595 2.18155874 2.18446581 2.18667937
 2.18645336 2.18364386 2.18328564 2.1856     2.18644544 2.18447993
 2.18332819 2.18253098 2.18498589 2.19147899 2.18888049 2.18834275
 2.18975116 2.1874282  2.18225039 2.17833904 2.18125856 2.18144661
 2.18096643 2.18231134 2.17816427 2.18094548 2.18208102 2.17645158
 2.17519898 2.17882873 2.18008806 2.18098657 2.17739229 2.17557334
 2.17316552 2.17074629 2.17511977 2.17386711 2.17516388 2.17070174
 2.16530673 2.16393476 2.16426489 2.17008317 2.16910059 2.1684587
 2.16793622 2.17088443 2.17078785 2.171324   2.17175055 2.17015173
 2.1683413  2.16733473 2.16563472 2.16312142 2.16383062 2.1617195
 2.16190717 2.16295764 2.15946144 2.16144866 2.15902644 2.15891269
 2.15749765 2.1583144  2.15844828 2.16055935 2.16376937 2.16699906
 2.16542054 2.16362687 2.15865835 2.15695622 2.15979145 2.16383048
 2.16350371 2.16706425 2.16772961 2.16803567 2.17120648 2.17236609
 2.17221647 2.1704065  2.16802176 2.170955   2.16998691 2.17247314
 2.17383636 2.17106671 2.1737029  2.17376176 2.17342138 2.17669254
 2.17552045 2.17697204 2.17724339 2.17697352 2.18011925 2.17871262
 2.1781471  2.1780788  2.17882167 2.17990609 2.18363467 2.1818755
 2.18329456 2.1841766  2.1827694  2.18214134 2.18105413 2.18357124
 2.18014064 2.17801464 2.17804513 2.18046527 2.18196847 2.17942854
 2.17813525 2.18164234 2.17705782 2.17857425 2.17707538 2.17872233
 2.17731619 2.17871691 2.17951797 2.17790059 2.17871287 2.1742059
 2.1738929  2.17367322 2.17082955 2.1705218  2.17029314 2.16772119
 2.16540439 2.16835736 2.16723912 2.16821036 2.16632933 2.16526534
 2.16532814 2.16578778 2.1630983  2.16086444 2.15896006 2.16000627
 2.15744673 2.15799669 2.15876042 2.15901761 2.1576025  2.15569587
 2.15304241 2.15313152 2.15162654 2.15220885 2.15333872 2.1534669
 2.15437172 2.15038622 2.14875045 2.14781843 2.14643081 2.14504587
 2.1441745  2.14346671 2.14270911 2.1441957  2.14343295 2.14441284
 2.14755261 2.14672717 2.1434589  2.14461149 2.14350286 2.14313274
 2.14418385 2.14461597 2.1449236  2.1454029  2.1442196  2.14810344
 2.15021036 2.14845918 2.147216   2.14627808 2.14411341 2.14119148
 2.14167648 2.14019877 2.14162669 2.13973751 2.13924918 2.13764119
 2.13773018 2.13823304 2.13792592 2.14037371 2.14134838 2.14228554
 2.14261967 2.14353422 2.14042076 2.13892604 2.13797516 2.13795973
 2.13860891 2.13916872 2.14007997 2.13669263 2.13869215 2.1375472
 2.13755334 2.13668667 2.13569832 2.13403829 2.13531834 2.13719702
 2.13580592 2.13459619 2.13348831 2.1350181  2.13240133 2.12866794
 2.12978797 2.13059605 2.12739571 2.12901519 2.12895288 2.13154142
 2.13143492 2.1339511  2.13389212 2.13552633 2.1367124  2.13647973
 2.13752844 2.1378242  2.13948176 2.13687641 2.13689162 2.13711003
 2.13569002 2.13426986 2.1356599  2.13772888 2.1346755  2.13270961
 2.13176019 2.13233589 2.13562593 2.13472515 2.13358434 2.13325699
 2.13316922 2.13259056 2.13157195 2.13311913 2.1327262  2.13228239
 2.13540169 2.13578454 2.13312307 2.13446611 2.13390204 2.13181273
 2.13194741 2.13075486 2.13143258 2.12780161 2.13068985 2.12958135
 2.12711699 2.12947104 2.12780033 2.12691603 2.12530863 2.12548614
 2.12620522 2.12689058 2.12804624 2.12905971 2.12944562 2.12880442
 2.12800929 2.12874546 2.12925913 2.13214887 2.13302935 2.13317554
 2.13290221 2.13358874 2.13241387 2.13055876 2.12776121 2.12694007
 2.12707114 2.12522218 2.12691504 2.12585971 2.12567689 2.12643795
 2.12692728 2.1269036  2.12507135 2.12717945 2.12509324 2.1260243
 2.12618415 2.12428049 2.12238552 2.12287922 2.12294618 2.1243062
 2.12745549 2.12665331 2.12779349 2.12739045 2.12746553 2.12767071
 2.12573295 2.12464417 2.12360555 2.12176882 2.12262773 2.1223172
 2.12186388 2.12201652 2.12164103 2.12206903 2.12393819 2.12383747
 2.12527848 2.12619387 2.12796577 2.12642161 2.12617764 2.12436692
 2.12179943 2.12161102 2.12187506 2.12206797 2.1241611  2.12470522
 2.12699609 2.12827502 2.12855602 2.12947162 2.12834263 2.1263053
 2.12585567 2.12596675 2.12745599 2.12737182 2.12850817 2.12651904
 2.12742326 2.12622084 2.1270247  2.12592001 2.12536031 2.12625654
 2.12739565 2.12901964 2.12671847 2.1257562  2.12606512 2.12436003
 2.12571008 2.12611194 2.12684152 2.12605383 2.1259984  2.12818884
 2.12974973 2.1302838  2.13148371 2.13072191 2.13131398 2.12886262
 2.12906212 2.12814732 2.12723102 2.12936932 2.12889463 2.12730868
 2.12724846 2.12702174 2.12886491 2.13035061 2.12977181 2.12984636
 2.13223512 2.13221898 2.13349641 2.13408678 2.13347688 2.13321814
 2.13579743 2.13714804 2.1391644  2.13897548 2.14090043 2.13915827
 2.13844708 2.13831457 2.13704584 2.13633313 2.13740656 2.13651901
 2.13551849 2.13473343 2.13300531 2.13415727 2.13186844 2.12921409
 2.13109327 2.12956947 2.12979636 2.12953591 2.13023065 2.13224046
 2.13029387 2.13137018 2.13193984 2.13199368 2.13307311 2.13384331
 2.13168437 2.13233878 2.13157712 2.13206583 2.1339216  2.13428846
 2.1347706  2.13413471 2.13237906 2.13216878 2.13214114 2.13371881
 2.1325042  2.13117074 2.13120026 2.13222994 2.13136174 2.13064616
 2.13111411 2.1286198  2.12722004 2.12821421 2.12807592 2.1301398
 2.12975203 2.12951391 2.12841087 2.12983254 2.13158459 2.13413109
 2.13471895 2.1347577  2.13348237 2.13107853 2.13090682 2.12967821
 2.13168226 2.13365892 2.13552126 2.1340829  2.13595123 2.13514274
 2.13465461 2.13500922 2.13434984 2.13525574 2.13376116 2.13399491
 2.13380067 2.13224993 2.132304   2.13226479 2.13044252 2.13022543
 2.13270053 2.13248304 2.13160587 2.13097728 2.13104165 2.1314159
 2.13014248 2.12883816 2.13152984 2.12969915 2.13073134 2.13315265
 2.13225857 2.13121145 2.13071743 2.13140866 2.13317561 2.13434853
 2.13381305 2.13397488 2.1328829  2.13193011 2.13314195 2.13283188
 2.13130612 2.13034888 2.13338612 2.13434158 2.13414199 2.13506355
 2.1354198  2.1352596  2.13552259 2.13471283 2.13367118 2.13280841
 2.13172397 2.13090542 2.13039076 2.12985353 2.13102756 2.13055671
 2.13150284 2.13349636 2.13470374 2.13438203 2.13283715 2.13308154
 2.13417048 2.13406249 2.13328696 2.13186663 2.13220479 2.1324468
 2.13196451 2.12871355 2.12786567 2.12784315 2.12774262 2.12659244
 2.12635282 2.12639366 2.12494685 2.12372474 2.12471545 2.12296822
 2.12089489 2.12168595 2.1228649  2.12176785 2.12065906 2.12078716
 2.12193804 2.12188334 2.12066409 2.12214806 2.12315892 2.12125274
 2.12189489 2.12346993 2.1238548  2.12529385 2.12550835 2.12406217
 2.12291191 2.12295329 2.12305626 2.12368621 2.1236948  2.12460768
 2.12659495 2.1271277  2.12680972 2.12756307 2.12763605 2.12811268
 2.12654014 2.12480516 2.12549699 2.12612664 2.12773362 2.12830198
 2.12770865 2.13009621 2.1299911  2.12972895 2.13176259 2.13243445
 2.13209545 2.13339965 2.13254711 2.13186582 2.13075469 2.1295081
 2.12890743 2.12950253 2.12878859 2.12959602 2.13053635 2.13139385
 2.13246988 2.13347514 2.13410181 2.13403211 2.13360438 2.13428947
 2.1343505  2.13347583 2.1350268  2.13450327 2.13285396 2.13332185
 2.13230543 2.13266094 2.13366514 2.13359469 2.13428788 2.13549582
 2.13485523 2.1350624  2.13460747 2.13503136] 1000
[   1    2    3    4    5    6    7    8    9   10   11   12   13   14
   15   16   17   18   19   20   21   22   23   24   25   26   27   28
   29   30   31   32   33   34   35   36   37   38   39   40   41   42
   43   44   45   46   47   48   49   50   51   52   53   54   55   56
   57   58   59   60   61   62   63   64   65   66   67   68   69   70
   71   72   73   74   75   76   77   78   79   80   81   82   83   84
   85   86   87   88   89   90   91   92   93   94   95   96   97   98
   99  100  101  102  103  104  105  106  107  108  109  110  111  112
  113  114  115  116  117  118  119  120  121  122  123  124  125  126
  127  128  129  130  131  132  133  134  135  136  137  138  139  140
  141  142  143  144  145  146  147  148  149  150  151  152  153  154
  155  156  157  158  159  160  161  162  163  164  165  166  167  168
  169  170  171  172  173  174  175  176  177  178  179  180  181  182
  183  184  185  186  187  188  189  190  191  192  193  194  195  196
  197  198  199  200  201  202  203  204  205  206  207  208  209  210
  211  212  213  214  215  216  217  218  219  220  221  222  223  224
  225  226  227  228  229  230  231  232  233  234  235  236  237  238
  239  240  241  242  243  244  245  246  247  248  249  250  251  252
  253  254  255  256  257  258  259  260  261  262  263  264  265  266
  267  268  269  270  271  272  273  274  275  276  277  278  279  280
  281  282  283  284  285  286  287  288  289  290  291  292  293  294
  295  296  297  298  299  300  301  302  303  304  305  306  307  308
  309  310  311  312  313  314  315  316  317  318  319  320  321  322
  323  324  325  326  327  328  329  330  331  332  333  334  335  336
  337  338  339  340  341  342  343  344  345  346  347  348  349  350
  351  352  353  354  355  356  357  358  359  360  361  362  363  364
  365  366  367  368  369  370  371  372  373  374  375  376  377  378
  379  380  381  382  383  384  385  386  387  388  389  390  391  392
  393  394  395  396  397  398  399  400  401  402  403  404  405  406
  407  408  409  410  411  412  413  414  415  416  417  418  419  420
  421  422  423  424  425  426  427  428  429  430  431  432  433  434
  435  436  437  438  439  440  441  442  443  444  445  446  447  448
  449  450  451  452  453  454  455  456  457  458  459  460  461  462
  463  464  465  466  467  468  469  470  471  472  473  474  475  476
  477  478  479  480  481  482  483  484  485  486  487  488  489  490
  491  492  493  494  495  496  497  498  499  500  501  502  503  504
  505  506  507  508  509  510  511  512  513  514  515  516  517  518
  519  520  521  522  523  524  525  526  527  528  529  530  531  532
  533  534  535  536  537  538  539  540  541  542  543  544  545  546
  547  548  549  550  551  552  553  554  555  556  557  558  559  560
  561  562  563  564  565  566  567  568  569  570  571  572  573  574
  575  576  577  578  579  580  581  582  583  584  585  586  587  588
  589  590  591  592  593  594  595  596  597  598  599  600  601  602
  603  604  605  606  607  608  609  610  611  612  613  614  615  616
  617  618  619  620  621  622  623  624  625  626  627  628  629  630
  631  632  633  634  635  636  637  638  639  640  641  642  643  644
  645  646  647  648  649  650  651  652  653  654  655  656  657  658
  659  660  661  662  663  664  665  666  667  668  669  670  671  672
  673  674  675  676  677  678  679  680  681  682  683  684  685  686
  687  688  689  690  691  692  693  694  695  696  697  698  699  700
  701  702  703  704  705  706  707  708  709  710  711  712  713  714
  715  716  717  718  719  720  721  722  723  724  725  726  727  728
  729  730  731  732  733  734  735  736  737  738  739  740  741  742
  743  744  745  746  747  748  749  750  751  752  753  754  755  756
  757  758  759  760  761  762  763  764  765  766  767  768  769  770
  771  772  773  774  775  776  777  778  779  780  781  782  783  784
  785  786  787  788  789  790  791  792  793  794  795  796  797  798
  799  800  801  802  803  804  805  806  807  808  809  810  811  812
  813  814  815  816  817  818  819  820  821  822  823  824  825  826
  827  828  829  830  831  832  833  834  835  836  837  838  839  840
  841  842  843  844  845  846  847  848  849  850  851  852  853  854
  855  856  857  858  859  860  861  862  863  864  865  866  867  868
  869  870  871  872  873  874  875  876  877  878  879  880  881  882
  883  884  885  886  887  888  889  890  891  892  893  894  895  896
  897  898  899  900  901  902  903  904  905  906  907  908  909  910
  911  912  913  914  915  916  917  918  919  920  921  922  923  924
  925  926  927  928  929  930  931  932  933  934  935  936  937  938
  939  940  941  942  943  944  945  946  947  948  949  950  951  952
  953  954  955  956  957  958  959  960  961  962  963  964  965  966
  967  968  969  970  971  972  973  974  975  976  977  978  979  980
  981  982  983  984  985  986  987  988  989  990  991  992  993  994
  995  996  997  998  999 1000] 1000 1000
1000
</pre></div>
</div>
<img alt="../_images/113cf8c23cdd729e2b862110a90101fcad0756f730361c5d69324a7244af54c0.png" src="../_images/113cf8c23cdd729e2b862110a90101fcad0756f730361c5d69324a7244af54c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nexperiments</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">multi_exp</span> <span class="o">=</span> <span class="n">run_lots_of_experiments</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">npulls</span><span class="p">,</span> <span class="n">nexperiments</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.53326354 1.55756413 1.64940297 ... 1.53793843 1.56447217 2.07303185]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">multi_exp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.53326354 1.55756413 1.64940297 ... 1.53793843 1.56447217 2.07303185]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi_exp_sample_av</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nexperiments</span><span class="p">)</span>
<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
<span class="n">sum_rewards</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_exp</span><span class="p">):</span>
    <span class="n">sum_rewards</span> <span class="o">+=</span> <span class="n">value</span>
    <span class="n">multi_exp_output</span> <span class="o">=</span> <span class="n">sample_average</span><span class="p">(</span><span class="n">sum_rewards</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">multi_exp_sample_av</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">multi_exp_output</span>
<span class="c1">#     print(count + 1, value, multi_exp_output, sum_rewards)</span>
  
<span class="nb">print</span><span class="p">(</span><span class="n">multi_exp_sample_av</span><span class="p">)</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nexperiments</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">multi_exp_sample_av</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y</span><span class="o">=</span><span class="n">multi_exp_sample_av</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Line graph&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">multi_exp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.53326354 1.54541384 1.58007688 ... 1.56364651 1.56364692 1.56390162]
[   1    2    3 ... 1998 1999 2000] 2000 2000
</pre></div>
</div>
<img alt="../_images/cf26b6a4c1dfe35d3104c767e9cdc88acf60fdb1adbc4f659ba668fe3abd42e9.png" src="../_images/cf26b6a4c1dfe35d3104c767e9cdc88acf60fdb1adbc4f659ba668fe3abd42e9.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="start-again-this-time-working-as-outlined-on-page-68-of-lab-book-2">
<h1>Start again: This time working as outlined on page 68 of lab book #2<a class="headerlink" href="#start-again-this-time-working-as-outlined-on-page-68-of-lab-book-2" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get initial distribution for first experiment</span>
<span class="n">k</span><span class="o">=</span><span class="mi">10</span>
<span class="n">action_value_mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">)</span>
<span class="n">n_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">))</span>
<span class="n">estimate_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.01905383 -0.07542735 -0.83914042 -0.37413245 -2.59096423  0.74891375
 -0.59680721 -0.44722528  0.24605155 -1.60191293]
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_bandit</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a k-armed bandit as outlines in the book&quot;&quot;&quot;</span>
    <span class="n">action_value_mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">action_value_mu</span>
    
<span class="k">def</span> <span class="nf">pick_arm</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">,</span> <span class="n">estimate_array</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
    <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">):</span> <span class="c1">#If the array is full of zeros then just pick an arm at random</span>
        <span class="n">choice</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="c1">#         print(&quot;all zeros&quot;)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Greedy and non-greedy choices</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">epsilon</span><span class="p">:</span> <span class="c1">#Explore</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="c1">#             print(&quot;explore&quot;)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#Exploit</span>
            <span class="n">maxval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">)</span>
            <span class="k">if</span><span class="p">(</span><span class="n">maxval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="n">exploit_pick_neg_or_zeroes</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">)</span>
                <span class="c1">#If all the non-zero values are &lt; 0 then pick a random zero value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">)</span>  <span class="c1">#If there is one non-zero value (&gt;0) then pick that.           </span>
<span class="c1">#             print(&quot;exploit&quot;)</span>
<span class="c1">#     print(&quot;pick arm&quot;, choice)</span>
    <span class="n">mu</span><span class="o">=</span><span class="n">action_value_mu</span><span class="p">[</span><span class="n">choice</span><span class="p">]</span>
    <span class="n">Rt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n_array</span><span class="p">[</span><span class="n">choice</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">estimate_array</span><span class="p">[</span><span class="n">choice</span><span class="p">]</span> <span class="o">=</span> <span class="n">update_estimate_array</span><span class="p">(</span><span class="n">Rt</span><span class="p">,</span> <span class="n">estimate_array</span><span class="p">[</span><span class="n">choice</span><span class="p">],</span> <span class="n">n_array</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">,</span> <span class="n">Rt</span><span class="p">)</span>
 
<span class="k">def</span> <span class="nf">exploit_pick_neg_or_zeroes</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take the estimate array, if all values are below 0 then pick the least negative one</span>
<span class="sd">    if some values are zero, and others below, pick a random zero from the contenders&quot;&quot;&quot;</span>
    <span class="n">contenders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">estimate_array</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contenders</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">contenders</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">choice</span>
    
<span class="k">def</span> <span class="nf">update_estimate_array</span><span class="p">(</span><span class="n">Rt</span><span class="p">,</span> <span class="n">previous_value</span><span class="p">,</span> <span class="n">n_pulls</span><span class="p">):</span>
    <span class="n">updated_values</span> <span class="o">=</span> <span class="n">previous_value</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">n_pulls</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Rt</span> <span class="o">-</span> <span class="n">previous_value</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">updated_values</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">reset_estimate_and_n_array</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">):</span>
    <span class="n">estimate_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">))</span>
    <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">estimate_array</span><span class="p">,</span> <span class="n">n_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_experiment</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">npulls</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a k-armed bandit and pull the lever npull times&quot;&quot;&quot;</span>
    <span class="n">action_value_mu</span> <span class="o">=</span> <span class="n">generate_bandit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#     print(action_value_mu)</span>
    <span class="n">estimate_array</span><span class="p">,</span> <span class="n">n_array</span> <span class="o">=</span> <span class="n">reset_estimate_and_n_array</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npulls</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npulls</span><span class="p">):</span>
        <span class="n">estimate_array</span><span class="p">,</span> <span class="n">reward</span> <span class="o">=</span> <span class="n">pick_arm</span><span class="p">(</span><span class="n">action_value_mu</span><span class="p">,</span> <span class="n">estimate_array</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span> <span class="c1">#epsilon=0 means greedy</span>
<span class="c1">#         print(_, np.around(estimate_array,2), np.around(reward,4))</span>
        <span class="n">scores</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="o">=</span><span class="n">reward</span>
<span class="c1">#     print(scores)</span>
<span class="c1">#     print(estimate_array)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">estimate_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_multiple_exp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">npulls</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">nexp</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nexp</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">old_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npulls</span><span class="p">)</span>
        <span class="n">new_scores</span><span class="p">,</span> <span class="n">estimate_array</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">npulls</span><span class="o">=</span><span class="n">npulls</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span><span class="p">)</span>
        <span class="n">average_scores</span> <span class="o">=</span> <span class="n">scores_averaging</span><span class="p">(</span><span class="n">old_scores</span><span class="p">,</span><span class="n">new_scores</span><span class="p">,</span><span class="n">nexp</span><span class="p">)</span>
        <span class="n">old_scores</span> <span class="o">=</span> <span class="n">new_scores</span>
    <span class="k">return</span> <span class="n">average_scores</span>

<span class="k">def</span> <span class="nf">scores_averaging</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">nexp</span><span class="p">):</span>
    <span class="n">new_av</span> <span class="o">=</span> <span class="n">old</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">nexp</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">new</span><span class="o">-</span><span class="n">old</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_av</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Greedy run 1000 pulls, 2000 experiments</span>
<span class="n">scores_array_average</span> <span class="o">=</span> <span class="n">run_multiple_exp</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">npulls</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nexp</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">scores_array_average</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">scores_array_average</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Line graph&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1939d1da15d1bbb6c8369490c8a29f2f90947cbbb3c341f36030f2dd2e12f240.png" src="../_images/1939d1da15d1bbb6c8369490c8a29f2f90947cbbb3c341f36030f2dd2e12f240.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Explore run 1000 pulls, 2000 experiments</span>
<span class="n">scores_array_average</span> <span class="o">=</span> <span class="n">run_multiple_exp</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">npulls</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nexp</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">scores_array_average</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">scores_array_average</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Line graph&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y axis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9a83b14d93b17ec0c4e0a03b9c376a30a9c631c2ebe76d1650c8898f1ecabdff.png" src="../_images/9a83b14d93b17ec0c4e0a03b9c376a30a9c631c2ebe76d1650c8898f1ecabdff.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chap02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">The 10 armed bandit problem</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#start-again-this-time-working-as-outlined-on-page-68-of-lab-book-2">Start again: This time working as outlined on page 68 of lab book #2</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Helen Duncan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>